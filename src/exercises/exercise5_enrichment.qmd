---
title: "Enrichment analysis"
format: html
editor: visual
execute:
  eval: false
---

### Exercise 0: Load DE results
Load the results produced in exercise 4 (skip if it's still in your environment).

```r
res <- readRDS("../../output/de_sex_time.rds")  # adapt path to your folder structure!

```

## DE gene list

### Exercise 1: Load DE genes for overrepresentation analysis

```r
gene_list <- rownames(res[which(res$padj < 0.05), ])
head(gene_list)
```
__Question__: How many significant genes do we have for enrichment? 

## Overrepresentation Analysis

### Exercise 2: Perform GO overrepresentation analysis

```r
library(clusterProfiler)
library(org.Mm.eg.db)

ego <- enrichGO(gene          = gene_list,
                OrgDb         = org.Mm.eg.db,
                keyType       = "ENTREZID",
                ont           = "BP",
                pAdjustMethod = "BH",
                qvalueCutoff  = 0.05)
ego

```
__Question__: How many GO terms are significant?

## Visualization

### Exercise 3: Plot top enriched GO terms

```r
barplot(ego, showCategory = 10)
```